        -:    0:Source:../../src/search.h
        -:    0:Programs:50
        -:    1:/* search.c - searching subroutines using dfa, kwset and regex for grep.
        -:    2:   Copyright 1992, 1998, 2000, 2007, 2009-2020 Free Software Foundation, Inc.
        -:    3:
        -:    4:   This program is free software; you can redistribute it and/or modify
        -:    5:   it under the terms of the GNU General Public License as published by
        -:    6:   the Free Software Foundation; either version 3, or (at your option)
        -:    7:   any later version.
        -:    8:
        -:    9:   This program is distributed in the hope that it will be useful,
        -:   10:   but WITHOUT ANY WARRANTY; without even the implied warranty of
        -:   11:   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        -:   12:   GNU General Public License for more details.
        -:   13:
        -:   14:   You should have received a copy of the GNU General Public License
        -:   15:   along with this program; if not, write to the Free Software
        -:   16:   Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA
        -:   17:   02110-1301, USA.  */
        -:   18:
        -:   19:#ifndef GREP_SEARCH_H
        -:   20:#define GREP_SEARCH_H 1
        -:   21:
        -:   22:#include <config.h>
        -:   23:
        -:   24:#include <sys/types.h>
        -:   25:#include <stdint.h>
        -:   26:#include <wchar.h>
        -:   27:#include <wctype.h>
        -:   28:#include <regex.h>
        -:   29:
        -:   30:#include "system.h"
        -:   31:#include "grep.h"
        -:   32:#include "dfa.h"
        -:   33:#include "kwset.h"
        -:   34:#include "xalloc.h"
        -:   35:#include "localeinfo.h"
        -:   36:
        -:   37:_GL_INLINE_HEADER_BEGIN
        -:   38:#ifndef SEARCH_INLINE
        -:   39:# define SEARCH_INLINE _GL_INLINE
        -:   40:#endif
        -:   41:
        -:   42:/* This must be a signed type.  Each value is the difference in the size
        -:   43:   of a character (in bytes) induced by converting to lower case.
        -:   44:   The vast majority of values are 0, but a few are 1 or -1, so
        -:   45:   technically, two bits may be sufficient.  */
        -:   46:typedef signed char mb_len_map_t;
        -:   47:
        -:   48:/* searchutils.c */
        -:   49:extern void wordinit (void);
        -:   50:extern kwset_t kwsinit (bool);
        -:   51:extern size_t wordchars_size (char const *, char const *) _GL_ATTRIBUTE_PURE;
        -:   52:extern size_t wordchar_next (char const *, char const *) _GL_ATTRIBUTE_PURE;
        -:   53:extern size_t wordchar_prev (char const *, char const *, char const *)
        -:   54:  _GL_ATTRIBUTE_PURE;
        -:   55:extern ptrdiff_t mb_goback (char const **, size_t *, char const *,
        -:   56:                            char const *);
        -:   57:
        -:   58:/* dfasearch.c */
        -:   59:extern void *GEAcompile (char *, size_t, reg_syntax_t, bool);
        -:   60:extern size_t EGexecute (void *, char const *, size_t, size_t *, char const *);
        -:   61:
        -:   62:/* kwsearch.c */
        -:   63:extern void *Fcompile (char *, size_t, reg_syntax_t, bool);
        -:   64:extern size_t Fexecute (void *, char const *, size_t, size_t *, char const *);
        -:   65:
        -:   66:/* pcresearch.c */
        -:   67:extern void *Pcompile (char *, size_t, reg_syntax_t, bool);
        -:   68:extern size_t Pexecute (void *, char const *, size_t, size_t *, char const *);
        -:   69:
        -:   70:/* grep.c */
        -:   71:extern struct localeinfo localeinfo;
        -:   72:extern void fgrep_to_grep_pattern (char **, size_t *);
        -:   73:
        -:   74:/* Return the number of bytes in the character at the start of S, which
        -:   75:   is of size N.  N must be positive.  MBS is the conversion state.
        -:   76:   This acts like mbrlen, except it returns 1 when mbrlen would return 0,
        -:   77:   and it is typically faster because of the cache.  */
        -:   78:SEARCH_INLINE size_t
function mb_clen called 106 returned 100% blocks executed 83%
      106:   79:mb_clen (char const *s, size_t n, mbstate_t *mbs)
        -:   80:{
      106:   81:  size_t len = localeinfo.sbclen[to_uchar (*s)];
call    0 returned 100%
      106:   82:  return len == (size_t) -2 ? mbrlen (s, n, mbs) : len;
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
call    2 never executed
        -:   83:}
        -:   84:
        -:   85:extern char const *input_filename (void);
        -:   86:
        -:   87:_GL_INLINE_HEADER_END
        -:   88:
        -:   89:#endif /* GREP_SEARCH_H */
